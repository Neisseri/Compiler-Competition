--------------------------- building ast ---------------------------
parse tree: 
(compUnit 
        (compUnitItem 
            (funcDef 
                (funcType 
                    (bType int)) main ( ) 
                (block { 
                    (blockItem 
                        (decl 
                            (varDecl 
                                (bType int) 
                                (varDef c = 
                                    (initVal 
                                        (exp 
                                            (addExp 
                                                (mulExp 
                                                    (unaryExp 
                                                        (primaryExp 
                                                            (number 
                                                                (intConst 4))))))))) ;))) 
                    (blockItem 
                        (stmt if ( 
                            (cond 
                                (lOrExp 
                                    (lAndExp 
                                        (eqExp 
                                            (relExp 
                                                (relExp 
                                                    (addExp 
                                                        (mulExp 
                                                            (unaryExp 
                                                                (primaryExp 
                                                                    (lVal c)))))) < 
                                                (addExp 
                                                    (mulExp 
                                                        (unaryExp 
                                                            (primaryExp 
                                                                (number 
                                                                    (intConst 75))))))))))) ) 
                            (stmt 
                                (block { 
                                    (blockItem 
                                        (decl 
                                            (varDecl 
                                                (bType int) 
                                                (varDef d) ;))) 
                                    (blockItem 
                                        (stmt 
                                            (lVal d) = 
                                            (exp 
                                                (addExp 
                                                    (mulExp 
                                                        (unaryExp 
                                                            (primaryExp 
                                                                (number 
                                                                    (intConst 42))))))) ;)) 
                                    (blockItem 
                                        (stmt if ( 
                                            (cond 
                                                (lOrExp 
                                                    (lAndExp 
                                                        (eqExp 
                                                            (relExp 
                                                                (relExp 
                                                                    (addExp 
                                                                        (mulExp 
                                                                            (unaryExp 
                                                                                (primaryExp 
                                                                                    (lVal c)))))) < 
                                                                (addExp 
                                                                    (mulExp 
                                                                        (unaryExp 
                                                                            (primaryExp 
                                                                                (number 
                                                                                    (intConst 100))))))))))) ) 
                                            (stmt 
                                                (block { 
                                                    (blockItem 
                                                        (stmt 
                                                            (lVal c) = 
                                                            (exp 
                                                                (addExp 
                                                                    (addExp 
                                                                        (mulExp 
                                                                            (unaryExp 
                                                                                (primaryExp 
                                                                                    (lVal c))))) + 
                                                                    (mulExp 
                                                                        (unaryExp 
                                                                            (primaryExp 
                                                                                (number 
                                                                                    (intConst 42))))))) ;)) 
                                                    (blockItem 
                                                        (stmt if ( 
                                                            (cond 
                                                                (lOrExp 
                                                                    (lAndExp 
                                                                        (eqExp 
                                                                            (relExp 
                                                                                (relExp 
                                                                                    (addExp 
                                                                                        (mulExp 
                                                                                            (unaryExp 
                                                                                                (primaryExp 
                                                                                                    (lVal c)))))) > 
                                                                                (addExp 
                                                                                    (mulExp 
                                                                                        (unaryExp 
                                                                                            (primaryExp 
                                                                                                (number 
                                                                                                    (intConst 99))))))))))) ) 
                                                            (stmt 
                                                                (block { 
                                                                    (blockItem 
                                                                        (decl 
                                                                            (varDecl 
                                                                                (bType int) 
                                                                                (varDef e) ;))) 
                                                                    (blockItem 
                                                                        (stmt 
                                                                            (lVal e) = 
                                                                            (exp 
                                                                                (addExp 
                                                                                    (mulExp 
                                                                                        (unaryExp 
                                                                                            (primaryExp 
                                                                                                (number 
                                                                                                    (intConst 84))))))) ;)) 
                                                                    (blockItem 
                                                                        (stmt 
                                                                            (lVal c) = 
                                                                            (exp 
                                                                                (addExp 
                                                                                    (mulExp 
                                                                                        (unaryExp 
                                                                                            (primaryExp 
                                                                                                (number 
                                                                                                    (intConst 168))))))) ;)) })))) })))) })))) 
                    (blockItem 
                        (stmt return 
                            (exp 
                                (addExp 
                                    (mulExp 
                                        (unaryExp 
                                            (primaryExp 
                                                (lVal c)))))) ;)) }))) <EOF>)
visitCompUnit
visitCompUnit: funcDef
construct funct block: main
visitVarDecl: int start
visitVarDecl: ident: c
visitVarDecl: initVal
visitInit
visitPrimaryExp_ number
visitPrimaryExp_ number
visit block stmt
visitVarDecl: int start
visitVarDecl: ident: d
visitPrimaryExp_ number
visitAssign done!
visitPrimaryExp_ number
visit block stmt
visitPrimaryExp_ number
visitAssign done!
visitPrimaryExp_ number
visit block stmt
visitVarDecl: int start
visitVarDecl: ident: e
visitPrimaryExp_ number
visitAssign done!
visitPrimaryExp_ number
visitAssign done!
visitBlock done!
visitBlock done!
visitBlock done!
visitBlock done!
construct funct block done!
visitCompUnit end create new program
visitCompUnit end create new program end
------------------------------type check------------------------------
Info: visitProgramProgram
Info: visitFuncDefint @main()
Info: visitBlock
Info: visitVarDef int @c = 4
Info: visitExpr4
Info: visitAssignmentExpr4
Info: visitExpr4
Info: visitIntLiteralExpr4
ret->type 0x55cc89a10920
Info: visitStatementIfElse
Info: visitExpr@c<75
Info: visitBinopExpr@c<75
Info: visitExpr@c
Info: visitLvalExpr@c
Info: visitExpr75
Info: visitIntLiteralExpr75
ret->type 0x55cc89a10950
Info: visitStatement
Info: visitBlock
Info: visitVarDef int @d
Info: visitStatementAssign@d = 42
Info: visitAssignStmtAssign@d = 42
Info: visitExpr@d
Info: visitLvalExpr@d
Info: visitAssignStmtint
Info: visitExpr42
Info: visitIntLiteralExpr42
ret->type 0x55cc89a10980
Info: visitStatementIfElse
Info: visitExpr@c<100
Info: visitBinopExpr@c<100
Info: visitExpr@c
Info: visitLvalExpr@c
Info: visitExpr100
Info: visitIntLiteralExpr100
ret->type 0x55cc89a109b0
Info: visitStatement
Info: visitBlock
Info: visitStatementAssign@c = @c+42
Info: visitAssignStmtAssign@c = @c+42
Info: visitExpr@c
Info: visitLvalExpr@c
Info: visitAssignStmtint
Info: visitExpr@c+42
Info: visitBinopExpr@c+42
Info: visitExpr@c
Info: visitLvalExpr@c
Info: visitExpr42
Info: visitIntLiteralExpr42
ret->type 0x55cc89a108f0
Info: visitStatementIfElse
Info: visitExpr@c>99
Info: visitBinopExpr@c>99
Info: visitExpr@c
Info: visitLvalExpr@c
Info: visitExpr99
Info: visitIntLiteralExpr99
ret->type 0x55cc89a12270
Info: visitStatement
Info: visitBlock
Info: visitVarDef int @e
Info: visitStatementAssign@e = 84
Info: visitAssignStmtAssign@e = 84
Info: visitExpr@e
Info: visitLvalExpr@e
Info: visitAssignStmtint
Info: visitExpr84
Info: visitIntLiteralExpr84
ret->type 0x55cc89a122a0
Info: visitStatementAssign@c = 168
Info: visitAssignStmtAssign@c = 168
Info: visitExpr@c
Info: visitLvalExpr@c
Info: visitAssignStmtint
Info: visitExpr168
Info: visitIntLiteralExpr168
ret->type 0x55cc89a12320
Info: visitStatementReturn @c
Info: visitExpr@c
Info: visitLvalExpr@c
Info: visitReturnStmtReturn @c#2function has returnscope id1
ast: 
Program
  int @main()
    {
      int @c#2 = 4
      If        @c#2<75
        {
          int @d#3
          Assign@d#3 = 42
          If            @c#2<100
            {
              Assign@c#2 = @c#2+42
              If                @c#2>99
                {
                  int @e#5
                  Assign@e#5 = 84
                  Assign@c#2 = 168
                }
            }
        }
      Return @c#2
    }
End of Program
--------------------------- building ir ---------------------------
visitProgram
visitFunction main
visitBlock 
visitExpression
visitExpression
visitExpressionintliteral
visitExpressionintliteral done
visitStatement
visitExpression
visitExpression
visitExpressionLValue c#2
visitExpression
visitExpressionintliteral
visitExpressionintliteral done
visitStatement
visitBlock 
visitStatement
visitExpression
visitExpressionintliteral
visitExpressionintliteral done
visitStatement
visitExpression
visitExpression
visitExpressionLValue c#2
visitExpression
visitExpressionintliteral
visitExpressionintliteral done
visitStatement
visitBlock 
visitStatement
visitExpression
visitExpression
visitExpressionLValue c#2
visitExpression
visitExpressionintliteral
visitExpressionintliteral done
visitStatement
visitExpression
visitExpression
visitExpressionLValue c#2
visitExpression
visitExpressionintliteral
visitExpressionintliteral done
visitStatement
visitBlock 
visitStatement
visitExpression
visitExpressionintliteral
visitExpressionintliteral done
visitStatement
visitExpression
visitExpressionintliteral
visitExpressionintliteral done
visitStatement
visitExpression
visitExpressionLValue c#2
function main has 20 regs
B0:
  prev: 
  succ: B1 
B1:
  prev: B0 
  succ: B2 B3 
B2:
  prev: B1 
  succ: B4 
B3:
  prev: B1 B6 
  succ: 
B4:
  prev: B2 
  succ: B5 B6 
B5:
  prev: B4 
  succ: B7 
B6:
  prev: B4 B9 
  succ: B3 
B7:
  prev: B5 
  succ: B8 B9 
B8:
  prev: B7 
  succ: B9 
B9:
  prev: B7 B8 
  succ: B6 
B10:
  prev: 
  succ: 

B0:
  prev: 
  succ: B1 
B1:
  prev: B0 
  succ: B2 B3 
B2:
  prev: B1 
  succ: B4 
B3:
  prev: B1 B6 
  succ: 
B4:
  prev: B2 
  succ: B5 B6 
B5:
  prev: B4 
  succ: B7 
B6:
  prev: B4 B9 
  succ: B3 
B7:
  prev: B5 
  succ: B8 B9 
B8:
  prev: B7 
  succ: B9 
B9:
  prev: B7 B8 
  succ: B6 

entryB0
B1
B2
B3
B4
B5
B6
B7
B8
B9
reverse_postorderB0
reverse_postorderB1
reverse_postorderB2
reverse_postorderB4
reverse_postorderB5
reverse_postorderB7
reverse_postorderB8
reverse_postorderB9
reverse_postorderB6
reverse_postorderB3
reverse_postorderB0
reverse_postorderB1
reverse_postorderB2
reverse_postorderB4
reverse_postorderB5
reverse_postorderB7
reverse_postorderB8
reverse_postorderB9
reverse_postorderB6
reverse_postorderB3
B0:
  doms: B1 
  domed_by: B0 
B1:
  doms: B2 B3 
  domed_by: B0 B1 
B2:
  doms: B4 
  domed_by: B0 B1 B2 
B3:
  doms: 
  domed_by: B0 B1 B3 
B4:
  doms: B5 B6 
  domed_by: B0 B1 B2 B4 
B5:
  doms: B7 
  domed_by: B0 B1 B2 B4 B5 
B6:
  doms: 
  domed_by: B0 B1 B2 B4 B6 
B7:
  doms: B8 B9 
  domed_by: B0 B1 B2 B4 B5 B7 
B8:
  doms: 
  domed_by: B0 B1 B2 B4 B5 B7 B8 
B9:
  doms: 
  domed_by: B0 B1 B2 B4 B5 B7 B9 

B0:
  DF: 
B1:
  DF: 
B2:
  DF: B3 
B3:
  DF: 
B4:
  DF: B3 
B5:
  DF: B6 
B6:
  DF: B3 
B7:
  DF: B6 
B8:
  DF: B9 
B9:
  DF: B6 

1____________________________________________________
dead code elimination ----------------------------------------------------------
main
B0
LoadInt
Other Instr
B1
LoadInt
Binary
Other Instr
B2
LoadInt
Other Instr
B3
Phi
Phi
Phi
Return
B4
LoadInt
Binary
Other Instr
B5
LoadInt
Binary
Other Instr
B6
Phi
Phi
Other Instr
B7
LoadInt
Binary
Other Instr
B8
LoadInt
LoadInt
Other Instr
B9
Phi
Phi
Other Instr
dead code elimination ----------------------------------------------------------
ir:
; module
define i32 @main(){
B0:
  %2 = 4
  br label B1

B1:
  %4 = 75
  %5 = icmp slt i32 %2, %4
  br i32 %5, label B2, label B3

B2:
  %7 = 42
  br label B4

B3:
  %25 = phi i32 [ %23, B6 ]
  %26 = phi i32 [ %7, B6 ]
  %27 = phi i32 [ %2, B1 ], [ %24, B6 ]
  ret i32 %27

B4:
  %9 = 100
  %10 = icmp slt i32 %2, %9
  br i32 %10, label B5, label B6

B5:
  %12 = 42
  %13 = add i32 %2, %12
  br label B7

B6:
  %23 = phi i32 [ %21, B9 ]
  %24 = phi i32 [ %2, B4 ], [ %22, B9 ]
  br label B3

B7:
  %15 = 99
  %16 = icmp sgt i32 %13, %15
  br i32 %16, label B8, label B9

B8:
  %18 = 84
  %19 = 168
  br label B9

B9:
  %21 = phi i32 [ %18, B8 ]
  %22 = phi i32 [ %13, B7 ], [ %19, B8 ]
  br label B6

}
--------------------------- building riscv ---------------------------
riscv: 
T[-23] B7
T[-7] B7
T[-2] B2
T[-24] B7
T[-21] B10
T[-2] B5
T[-22] B10
T[-18] B9
T[-13] B8
T[-19] B9
?
main
main Main()
main
after compute reg_used
after prologue
end of emitend
